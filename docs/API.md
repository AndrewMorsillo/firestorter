<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [Collection][1]
    -   [Parameters][2]
    -   [Examples][3]
    -   [docs][4]
        -   [Examples][5]
    -   [ref][6]
        -   [Examples][7]
    -   [id][8]
    -   [path][9]
        -   [Examples][10]
    -   [query][11]
        -   [Examples][12]
    -   [mode][13]
    -   [isActive][14]
    -   [fetch][15]
        -   [Examples][16]
    -   [isLoading][17]
        -   [Examples][18]
    -   [ready][19]
        -   [Examples][20]
    -   [add][21]
        -   [Parameters][22]
        -   [Examples][23]
    -   [deleteAll][24]
    -   [addObserverRef][25]
    -   [addObserverRef][26]
    -   [addObserverRef][27]
    -   [addObserverRef][28]
-   [Document][29]
    -   [Parameters][30]
    -   [schema][31]
    -   [data][32]
        -   [Examples][33]
    -   [ref][34]
        -   [Examples][35]
    -   [id][36]
    -   [path][37]
        -   [Examples][38]
    -   [mode][39]
    -   [isActive][40]
    -   [snapshot][41]
    -   [update][42]
        -   [Parameters][43]
        -   [Examples][44]
    -   [set][45]
        -   [Parameters][46]
        -   [Examples][47]
    -   [delete][48]
    -   [fetch][49]
        -   [Examples][50]
    -   [isLoading][51]
        -   [Examples][52]
    -   [ready][53]
        -   [Examples][54]
    -   [mergeUpdateData][55]
        -   [Parameters][56]
-   [initFirestorter][57]
    -   [Parameters][58]
    -   [Examples][59]

## Collection

The Collection class lays at the heart of `firestorter`.
It represents a collection in Firestore and its queried data. It is
observable so that it can be efficiently linked to a React Component
using `mobx-react`'s `observer` pattern.

Collection supports three modes of real-time updating:

-   "off" (real-time updating is turned off)
-   "on" (real-time updating is permanently turned on)
-   "auto" (real-time updating is enabled on demand) (default)

The "auto" mode ensures that Collection only communicates with
the firestore back-end whever the Collection is actually
rendered by a Component. This prevents unneccesary background
updates and leads to the best possible performance.

When real-time updates are enabled, data is automatically fetched
from Firestore whenever it changes in the back-end (using `onSnapshot`).
This enables almost magical instant updates. When data is changed,
only those documents are updated that have actually changed. Document
objects are re-used where possible, and just their data is updated.
The same is true for the `docs` property. If no documents where
added, removed, re-ordered, then the `docs` property itself will not
change.

Alternatively, you can keep real-time updates turned off and fetch
manually. This will update the Collection as efficiently as possible.
If nothing has changed on the back-end, no new Documents would be
created or modified.

### Parameters

-   `source` **(CollectionReference | [string][60] | function (): ([string][60] | void))** 
-   `options` **[Object][61]?** Configuration options
    -   `options.query` **([Function][62] | Query)?** See `Collection.query`
    -   `options.mode` **[String][60]?** See `Collection.mode`
    -   `options.DocumentClass` **[String][60]?** Document classes to create (must be inherited from Document)
    -   `options.minimizeUpdates` **Bool?** Enables additional algorithms to reduces updates to your app (e.g. when snapshots are received in rapid succession)
    -   `options.debug` **Bool?** Enables debug logging
    -   `options.debugName` **[String][60]?** Name to use when debug logging is enabled

### Examples

```javascript
import {Collection} from 'firestorter';

// Create a collection using path (preferred)
const col = new Collection('artists/Metallica/albums');

// Create a collection using a reference
const col2 = new Collection(firebase.firestore().collection('todos'));

// Create a collection and permanently start real-time updating
const col2 = new Collection('artists', {
  mode: 'on'
});

// Create a collection with a query on it
const col3 = new Collection('artists', {
  query: (ref) => ref.orderBy('name', 'asc')
});
```

```javascript
// In manual mode, just call `fetch` explicitely
const col = new Collection('albums');
col.fetch().then((collection) => {
 collection.docs.forEach((doc) => console.log(doc));
});

// Yo can use the `isLoading` property to see whether a fetch
// is in progress
console.log(col.isLoading);
```

### docs

Array of all the documents that have been fetched
from firestore.

#### Examples

```javascript
collection.docs.forEach((doc) => {
  console.log(doc.data);
});
```

Returns **[Array][63]&lt;[Document][64]>** 

### ref

Firestore collection reference.

Use this property to get or set the collection
reference. When set, a fetch to the new collection
is performed.

Alternatively, you can also use `path` to change the
reference in more a readable way.

#### Examples

```javascript
const col = new Collection(firebase.firestore().collection('albums/splinter/tracks'));
...
// Switch to another collection
col.ref = firebase.firestore().collection('albums/americana/tracks');
```

Returns **CollectionReference?** 

### id

Id of the Firestore collection (e.g. 'tracks').

To get the full-path of the collection, use `path`.

Returns **[string][60]?** 

### path

Path of the collection (e.g. 'albums/blackAlbum/tracks').

Use this property to switch to another collection in
the back-end. Effectively, it is a more compact
and readable way of setting a new ref.

#### Examples

```javascript
const col = new Collection('artists/Metallica/albums');
...
// Switch to another collection in the back-end
col.path = 'artists/EaglesOfDeathMetal/albums';
```

Returns **[string][60]?** 

### query

Use this property to set any order-by, where,
limit or start/end criteria. When set, that query
is used to retrieve any data. When cleared, the collection
reference is used.

The query can be either a Function of the form
`(CollectionReference) => Query` (preferred), or a direct
Firestore Query object.

#### Examples

```javascript
const todos = new Collection('todos');

// Sort the collection
todos.query = (ref) => ref.orderBy('text', 'asc');

// Order, filter & limit
todos.query = (ref) => ref.where('finished', '==', false).orderBy('finished', 'asc').limit(20);

// Clear the query, will cause whole collection to be fetched
todos.query = undefined;
```

Returns **(function (CollectionReference): Query? | Query)** 

### mode

Real-time updating mode.

Can be set to any of the following values:

-   "auto" (enables real-time updating when the collection is observed)
-   "off" (no real-time updating, you need to call fetch explicitly)
-   "on" (real-time updating is permanently enabled)

Returns **[string][60]** 

### isActive

Returns true when the Collection is actively listening
for changes in the firestore back-end.

Returns **[boolean][65]** 

### fetch

Fetches new data from firestore. Use this to manually fetch
new data when `mode` is set to 'off'.

#### Examples

```javascript
const col = new Collection('albums', 'off');
col.fetch().then(({docs}) => {
  docs.forEach(doc => console.log(doc));
});
```

Returns **[Promise][66]&lt;[Collection][67]>** 

### isLoading

True when new data is being loaded.

Fetches are performed in these cases:

-   When real-time updating is started
-   When a different `ref` or `path` is set
-   When a `query` is set or cleared
-   When `fetch` is explicitely called

#### Examples

```javascript
const col = new Collection('albums', {mode: 'off'});
console.log(col.isLoading);  // false
col.fetch();                 // start fetch
console.log(col.isLoading);  // true
await col.ready();           // wait for fetch to complete
console.log(col.isLoading);  // false
```

```javascript
const col = new Collection('albums');
console.log(col.isLoading);  // false
const dispose = autorun(() => {
  console.log(col.docs);     // start observing collection data
});
console.log(col.isLoading);  // true
...
dispose();                   // stop observing collection data
console.log(col.isLoading);  // false
```

Returns **[boolean][65]** 

### ready

Promise that is resolved when the Collection has
finished fetching its (initial) documents.

Use this method to for instance wait for
the initial snapshot update to complete, or to wait
for fresh data after changing the path/ref.

#### Examples

```javascript
const col = new Collection('albums', {mode: 'on'});
await col.ready();
console.log('albums: ', col.docs);
```

```javascript
const col = new Collection('artists/FooFighters/albums', {mode: 'on'});
await col.ready();
...
// Changing the path causes a new snapshot update
col.path = 'artists/TheOffspring/albums';
await col.ready();
console.log('albums: ', col.docs);
```

Returns **[Promise][66]&lt;void>** 

### add

Add a new document to this collection with the specified
data, assigning it a document ID automatically.

#### Parameters

-   `data` **any** 

#### Examples

```javascript
const doc = await collection.add({
  finished: false,
  text: 'New todo',
  options: {
    highPrio: true
  }
});
```

Returns **[Promise][66]&lt;[Document][64]>** 

### deleteAll

Deletes all the documents in the collection or query.

TODO - Not implemented yet

Returns **[Promise][66]&lt;void>** 

### addObserverRef

Limit used for query pagination.

Returns **[number][68]** 

### addObserverRef

Paginates to the start of the collection,
resetting any pagination cursor that exists.

Returns **[number][68]** 

### addObserverRef

Paginates to the next page. This sets the cursor
to `startAfter` the last document.

Returns **[Boolean][65]** False in case pagination was not possible

### addObserverRef

Paginates to the previous page. This sets the cursor
to `endBefore` the first document in `docs`.

Returns **[Boolean][65]** False in case pagination was not possible

## Document

Document represents a document stored in the firestore no-sql database.
Document is observable so that it can be efficiently linked to a React
Component using `mobx-react`'s `observer` pattern. This ensures that a
component is only re-rendered when data that is accessed in the `render`
function has changed.

### Parameters

-   `source` **(DocumentReference | [string][60] | function (): ([string][60] | void))** 
-   `options` **[Object][61]?** Configuration options
    -   `options.mode` **[String][60]?** See `Document.mode` (default: auto)
    -   `options.schema` **[Object][61]?** Superstruct schema for data validation
    -   `options.snapshot` **DocumentSnapshot?** Initial document snapshot
    -   `options.debug` **Bool?** Enables debug logging
    -   `options.debugName` **[String][60]?** Name to use when debug logging is enabled

### schema

Returns the superstruct schema used to validate the
document, or undefined.

Returns **any** 

### data

Returns the data inside the firestore document.

#### Examples

```javascript
todos.docs.map((doc) => {
 console.log(doc.data);
  // {
  //   finished: false
  //   text: 'Must do this'
  // }
});
```

Returns **any** 

### ref

Firestore document reference.

Use this property to get or set the
underlying document reference.

Alternatively, you can also use `path` to change the
reference in more a readable way.

#### Examples

```javascript
const doc = new Document('albums/splinter');

// Get the DocumentReference for `albums/splinter`
const ref = doc.ref;

// Switch to another document
doc.ref = firebase.firestore().doc('albums/americana');
```

Returns **DocumentReference?** 

### id

Id of the firestore document.

To get the full-path of the document, use `path`.

Returns **[string][60]?** 

### path

Path of the document (e.g. 'albums/blackAlbum').

Use this property to switch to another document in
the back-end. Effectively, it is a more compact
and readable way of setting a new ref.

#### Examples

```javascript
const doc = new Document('artists/Metallica');
...
// Switch to another document in the back-end
doc.path = 'artists/EaglesOfDeathMetal';

// Or, you can use a reactive function to link
// to the contents of another document.
const doc2 = new Document('settings/activeArtist');
doc.path = () => 'artists/' + doc2.data.artistId;
```

Returns **[string][60]?** 

### mode

Real-time updating mode.

Can be set to any of the following values:

-   "auto" (enables real-time updating when the document becomes observed)
-   "off" (no real-time updating, you need to call fetch explicitly)
-   "on" (real-time updating is permanently enabled)

Returns **[string][60]** 

### isActive

Returns true when the Document is actively listening
for changes in the firestore back-end.

Returns **[boolean][65]** 

### snapshot

Underlying firestore snapshot.

Returns **DocumentSnapshot** 

### update

Updates one or more fields in the document.

The update will fail if applied to a document that does
not exist.

#### Parameters

-   `fields` **any** 

#### Examples

```javascript
await todoDoc.update({
 finished: true,
  text: 'O yeah, checked this one off',
  foo: {
    bar: 10
  }
});
```

Returns **[Promise][66]&lt;void>** 

### set

Writes to the document.

If the document does not exist yet, it will be created.
If you pass options, the provided data can be merged into
the existing document.

#### Parameters

-   `data` **[Object][61]** An object of the fields and values for the document
-   `options` **[Object][61]?** Set behaviour options
    -   `options.merge` **[Boolean][65]?** Set to `true` to only replace the values specified in the data argument. Fields omitted will remain untouched.

#### Examples

```javascript
const todo = new Document('todos/mynewtodo');
await todo.set({
 finished: false,
  text: 'this is awesome'
});
```

Returns **[Promise][66]&lt;void>** 

### delete

Deletes the document in Firestore.

Returns a promise that resolves once the document has been
successfully deleted from the backend (Note that it won't
resolve while you're offline).

Returns **[Promise][66]&lt;void>** 

### fetch

Fetches new data from firestore. Use this to manually fetch
new data when `mode` is set to 'off'.

#### Examples

```javascript
const doc = new Document('albums/splinter', 'off');
doc.fetch().then(({data}) => {
  console.log('data: ', data);
});
```

Returns **[Promise][66]&lt;[Document][64]>** 

### isLoading

True when new data is being loaded.

Loads are performed in these cases:

-   When real-time updating is started
-   When a different `ref` or `path` is set
-   When a `query` is set or cleared
-   When `fetch` is explicitely called

#### Examples

```javascript
const doc = new Document('albums/splinter', {mode: 'off'});
console.log(doc.isLoading); 	// false
doc.fetch(); 								// start fetch
console.log(doc.isLoading); 	// true
await doc.ready(); 					// wait for fetch to complete
console.log(doc.isLoading); 	// false
```

```javascript
const doc = new Document('albums/splinter');
console.log(doc.isLoading); 	// false
const dispose = autorun(() => {
  console.log(doc.data);			// start observing document data
});
console.log(doc.isLoading); 	// true
...
dispose();										// stop observing document data
console.log(doc.isLoading); 	// false
```

Returns **[boolean][65]** 

### ready

Promise that is resolved when the Document has
data ready to be consumed.

Use this function to for instance wait for
the initial snapshot update to complete, or to wait
for fresh data after changing the path/ref.

#### Examples

```javascript
const doc = new Document('albums/splinter', {mode: 'on'});
await doc.ready();
console.log('data: ', doc.data);
```

```javascript
const doc = new Document('albums/splinter', {mode: 'on'});
await doc.ready();
...
// Changing the path causes a new snapshot update
doc.path = 'albums/americana';
await doc.ready();
console.log('data: ', doc.data);
```

Returns **[Promise][66]&lt;void>** 

### mergeUpdateData

Helper function which merges data into the source
and returns the new object.

#### Parameters

-   `data` **[Object][61]** JSON data
-   `fields` **[Object][61]** JSON data that supports field-paths

Returns **[Object][61]** Result

## initFirestorter

Initializes `firestorter` with the firebase-app.

### Parameters

-   `config` **[Object][61]** Configuration options
    -   `config.firebase` **Firebase** Firebase reference
    -   `config.app` **([String][60] | FirebaseApp)?** FirebaseApp to use (when omitted the default app is used)

### Examples

```javascript
import firebase from 'firebase';
import 'firebase/firestore';
import {initFirestorter, Collection, Document} from 'firestorter';

// Initialize firebase app
firebase.initializeApp({...});

// Initialize `firestorter`
initFirestorter({firebase: firebase});

// Create collection or document
const albums = new Collection('artists/Metallica/albums');
...
const album = new Document('artists/Metallica/albums/BlackAlbum');
...
```

[1]: #collection

[2]: #parameters

[3]: #examples

[4]: #docs

[5]: #examples-1

[6]: #ref

[7]: #examples-2

[8]: #id

[9]: #path

[10]: #examples-3

[11]: #query

[12]: #examples-4

[13]: #mode

[14]: #isactive

[15]: #fetch

[16]: #examples-5

[17]: #isloading

[18]: #examples-6

[19]: #ready

[20]: #examples-7

[21]: #add

[22]: #parameters-1

[23]: #examples-8

[24]: #deleteall

[25]: #addobserverref

[26]: #addobserverref-1

[27]: #addobserverref-2

[28]: #addobserverref-3

[29]: #document

[30]: #parameters-2

[31]: #schema

[32]: #data

[33]: #examples-9

[34]: #ref-1

[35]: #examples-10

[36]: #id-1

[37]: #path-1

[38]: #examples-11

[39]: #mode-1

[40]: #isactive-1

[41]: #snapshot

[42]: #update

[43]: #parameters-3

[44]: #examples-12

[45]: #set

[46]: #parameters-4

[47]: #examples-13

[48]: #delete

[49]: #fetch-1

[50]: #examples-14

[51]: #isloading-1

[52]: #examples-15

[53]: #ready-1

[54]: #examples-16

[55]: #mergeupdatedata

[56]: #parameters-5

[57]: #initfirestorter

[58]: #parameters-6

[59]: #examples-17

[60]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[61]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[62]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[63]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[64]: #document

[65]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[66]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[67]: #collection

[68]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number
